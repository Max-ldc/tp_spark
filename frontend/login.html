<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CESI Temperature API - Connexion</title>
    <link rel="stylesheet" href="styles.css?v=2">
    <!-- Keycloak supprim√© -->
</head>

<body>
    <div class="container">
        <div class="login-card">
            <div class="logo-section">
                <div class="logo">
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="30" cy="30" r="28" stroke="url(#gradient)" stroke-width="4" />
                        <path d="M30 15 L30 30 L42 30" stroke="url(#gradient)" stroke-width="3"
                            stroke-linecap="round" />
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <h1>CESI Temperature API</h1>
                <p class="subtitle">Connexion s√©curis√©e par Cl√© API</p>
            </div>

            <div id="auth-section">
                <!-- Onglets de connexion -->
                <div class="auth-tabs">
                    <button id="tab-apikey" class="tab-btn active" onclick="switchTab('apikey')">Cl√© API</button>
                    <button id="tab-cert" class="tab-btn" onclick="switchTab('cert')">Certificat X.509</button>
                </div>

                <!-- Formulaire Cl√© API -->
                <div id="apikey-section" class="auth-section active">
                    <div class="form-group">
                        <label for="api-key">Votre Cl√© API</label>
                        <input type="password" id="api-key" placeholder="Entrez votre cl√© API...">

                    </div>
                    <button class="login-btn" id="login-apikey-btn" onclick="loginWithApiKey()">Se connecter</button>
                </div>

                <!-- Formulaire Certificat -->
                <div id="cert-section" class="auth-section">
                    <div class="form-group">
                        <label>S√©lectionnez votre certificat (.pem)</label>
                        <div id="drop-zone" class="drop-zone">
                            <span class="drop-zone__prompt">Glissez votre certificat .pem ici ou cliquez pour
                                choisir</span>
                            <input type="file" id="cert-file" class="drop-zone__input" accept=".pem">
                        </div>
                        <div id="file-info" class="file-info" style="display:none;">
                            <span id="file-name">Aucun fichier</span>
                            <button class="remove-file" onclick="removeCertFile()">√ó</button>
                        </div>
                    </div>
                    <button class="login-btn" id="login-cert-btn" onclick="loginWithCertificate()" disabled>Se connecter
                        avec certificat</button>
                </div>


                <div class="user-info" id="user-info" style="display: none;">
                    <div class="success-icon">‚úì</div>
                    <h2>Authentification r√©ussie !</h2>
                    <div class="user-details">
                        <p><strong>Utilisateur :</strong> <span id="username"></span></p>
                        <p><strong>R√¥le :</strong> <span id="user-role" class="role-badge"></span></p>
                    </div>
                    <button class="dashboard-btn" onclick="goToDashboard()">
                        Acc√©der au Dashboard
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 3L9 4L15 10L9 16L10 17L17 10L10 3Z" />
                        </svg>
                    </button>
                    <div style="margin-top: 15px;">
                        <button class="cancel-btn" onclick="logout()" style="width: 100%;">D√©connexion</button>
                    </div>
                </div>
            </div>

            <div class="footer">
                <p>üîê Acc√®s s√©curis√© RBAC (Role-Based Access Control)</p>
                <p class="small">CESI M2 - Donn√©es Distribu√©es</p>
            </div>
        </div>
    </div>

    <script src="app.js?v=2"></script>
</body>

</html>