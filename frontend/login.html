<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CESI Temperature API - Connexion</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/keycloak-js@23/dist/keycloak.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="login-card">
            <div class="logo-section">
                <div class="logo">
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="30" cy="30" r="28" stroke="url(#gradient)" stroke-width="4"/>
                        <path d="M30 15 L30 30 L42 30" stroke="url(#gradient)" stroke-width="3" stroke-linecap="round"/>
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <h1>CESI Temperature API</h1>
                <p class="subtitle">Syst√®me d'authentification s√©curis√©</p>
            </div>

            <div id="auth-section">
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Initialisation de l'authentification...</p>
                </div>

                <div class="auth-methods" id="auth-methods" style="display: none;">
                    <h2>Choisissez votre m√©thode de connexion</h2>
                    
                    <button class="auth-button keycloak-btn" onclick="loginWithKeycloak()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                            <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                            <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                        </svg>
                        <div>
                            <div class="btn-title">Keycloak SSO</div>
                            <div class="btn-subtitle">Authentification d'entreprise</div>
                        </div>
                    </button>

                    <div class="divider">
                        <span>ou</span>
                    </div>

                    <button class="auth-button api-key-btn" onclick="showApiKeyForm()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M15 7C15 8.65685 13.6569 10 12 10C10.3431 10 9 8.65685 9 7C9 5.34315 10.3431 4 12 4C13.6569 4 15 5.34315 15 7Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 10V20M12 20L9 17M12 20L15 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <div>
                            <div class="btn-title">Cl√© API</div>
                            <div class="btn-subtitle">Pour d√©veloppeurs</div>
                        </div>
                    </button>

                    <div class="api-key-form" id="api-key-form" style="display: none;">
                        <input type="text" id="api-key-input" placeholder="Entrez votre cl√© API" class="api-key-input">
                        <button class="submit-btn" onclick="loginWithApiKey()">Se connecter</button>
                        <button class="cancel-btn" onclick="hideApiKeyForm()">Annuler</button>
                    </div>
                </div>

                <div class="user-info" id="user-info" style="display: none;">
                    <div class="success-icon">‚úì</div>
                    <h2>Authentification r√©ussie !</h2>
                    <div class="user-details">
                        <p><strong>Utilisateur :</strong> <span id="username"></span></p>
                        <p><strong>R√¥le :</strong> <span id="user-role" class="role-badge"></span></p>
                        <p><strong>M√©thode :</strong> <span id="auth-method"></span></p>
                    </div>
                    <button class="dashboard-btn" onclick="goToDashboard()">
                        Acc√©der au Dashboard
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 3L9 4L15 10L9 16L10 17L17 10L10 3Z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="footer">
                <p>üîê Authentification hybride : Keycloak SSO, JWT, API Keys</p>
                <p class="small">CESI M2 - Donn√©es Distribu√©es</p>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
